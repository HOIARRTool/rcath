<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RCA Assistant</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;500;700&display=swap" rel="stylesheet">

  <style>
    /* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ï‡∏≤‡∏£‡∏≤‡∏á PDSA ‡πÑ‡∏°‡πà‡∏Å‡∏¥‡∏ô‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏à‡∏≠ */
    .pdsatable { width: 100%; table-layout: auto; }
    .pdsatable th, .pdsatable td { vertical-align: top; }
    .pdsatable th:first-child,
    .pdsatable td:first-child{
      width: 110px;          /* ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô 90-140 ‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏ä‡∏≠‡∏ö */
      white-space: nowrap;   /* ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ Plan/Do ‡πÅ‡∏ï‡∏Å‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î (‡∏ñ‡πâ‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©) */
    }
    .pdsatable td:nth-child(2){ width: auto; }
    body { font-family: 'Noto Sans Thai', sans-serif; background-color: #F8FAFC; }
    .loader { border: 3px solid #f3f3f3; border-radius: 50%; border-top: 3px solid #0EA5E9; width: 20px; height: 20px; animation: spin 1s linear infinite; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    /* ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå‡∏Å‡∏£‡∏≤‡∏ü (Chart.js maintainAspectRatio:false ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á) */
    .chart-container { position: relative; width: 100%; height: 360px; }
    @media (max-width: 640px) { .chart-container { height: 320px; } }

    /* ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: Desktop ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏î‡∏±‡∏ô‡∏•‡πâ‡∏ô / Mobile ‡∏¢‡∏±‡∏á‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏î‡πâ */
    #analyzeResult, #planResult {
      width: 100%;
      max-width: 100%;
      overflow-x: hidden;
      -webkit-overflow-scrolling: touch;
    }
    @media (max-width: 768px) {
      #analyzeResult, #planResult { overflow-x: auto; }
    }

    /* ‚úÖ ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ï‡πá‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏´‡∏±‡∏Å‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ö‡∏ô Desktop */
    table {
      width: 100% !important;
      max-width: 100% !important;
      border-collapse: collapse;
      table-layout: fixed;
    }
    th, td {
      vertical-align: top;
      word-break: break-word;
      overflow-wrap: anywhere;
      white-space: normal;
    }

    /* ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡πâ‡∏≤‡∏á‡∏õ‡∏•‡∏≤ (‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°) ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÅ‡∏ô‡πà ‡πÜ */
    .fishbone-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
      margin-bottom: 14px;
    }
    @media (min-width: 768px) {
      .fishbone-grid { grid-template-columns: 1fr 1fr; }
    }
    .fishbone-card {
      background: #fff;
      border: 1px solid #E2E8F0;
      border-radius: 12px;
      padding: 12px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.04);
    }
    .fishbone-header {
      font-weight: 800;
      color: #0F172A;
      margin-bottom: 8px;
      font-size: 0.95rem;
    }

    /* ‡∏Ç‡∏±‡πâ‡∏ô‡∏ó‡∏≥‡πÑ‡∏°-‡∏ó‡∏≥‡πÑ‡∏° (UI ‡∏™‡∏ß‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô + ‡∏Ñ‡∏á‡∏£‡∏π‡∏õ) */
    .why-step { display: flex; align-items: flex-start; gap: 10px; padding: 6px 0; }
    .why-number {
      width: 24px; height: 24px; border-radius: 9999px;
      background: #fff; border: 2px solid #F472B6;
      color: #BE185D; font-weight: 800; font-size: 12px;
      display: flex; align-items: center; justify-content: center;
      flex: 0 0 auto;
    }
    .why-line { width: 2px; background: #F9A8D4; margin-top: 24px; margin-left: 11px; height: 18px; flex: 0 0 auto; }

    /* ‡πÄ‡∏™‡πâ‡∏ô‡πÑ‡∏ó‡∏°‡πå‡πÑ‡∏•‡∏ô‡πå (‡πÇ‡∏£‡∏î‡πÅ‡∏°‡∏õ) */
    .timeline-line {
      position: absolute;
      top: 0;
      bottom: 0;
      width: 2px;
      background: #CBD5E1;
    }
    /* ‚úÖ SVG ‡∏Å‡πâ‡∏≤‡∏á‡∏õ‡∏•‡∏≤: ‡∏Å‡∏±‡∏ô‡πÇ‡∏î‡∏ô‡∏ö‡∏µ‡∏ö‡∏ö‡∏ô‡∏à‡∏≠‡πÅ‡∏Ñ‡∏ö */
    .fishbone-viz-wrap { overflow-x: auto; -webkit-overflow-scrolling: touch; }
    .fishbone-viz-wrap svg { min-width: 980px; }

    @media (max-width: 640px) {
      h2 { font-size: 1.25rem !important; line-height: 1.4 !important; }
      .md\:p-10 { padding: 1rem !important; }
      .p-6 { padding: 1rem !important; }
      table td, table th {
        font-size: 0.75rem !important;
        padding: 8px 6px !important;
      }
    }
  </style>
</head>

<body class="bg-slate-50">

  <main class="w-full px-4 2xl:px-12 pt-10 pb-16 relative z-20">

    <section id="ai-lab">
      <div class="bg-gradient-to-r from-indigo-600 to-blue-600 rounded-3xl p-1 shadow-2xl overflow-hidden">
        <div class="bg-white rounded-[20px] p-6 md:p-10">

          <div class="text-center mb-10">
            <span class="bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide">‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡πÅ‡∏ö‡∏ö‡πÇ‡∏ï‡πâ‡∏ï‡∏≠‡∏ö</span>
            <h2 class="text-3xl md:text-4xl font-extrabold text-slate-800 mt-4 mb-2 flex items-center justify-center gap-3">
              <span>‚ú®</span> RCA Assistant
            </h2>
            <p class="text-slate-500 max-w-2xl mx-auto">
              ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏£‡∏≤‡∏Å‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏ (RCA) ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏¢‡∏¥‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô
            </p>
          </div>

          <!-- ‚úÖ Desktop: ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÄ‡∏ï‡πá‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ -->
          <div class="flex flex-col gap-8 w-full">

            <!-- ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô 1 -->
            <div class="space-y-6 w-full">
              <div class="bg-slate-50 rounded-2xl p-6 border border-slate-200 shadow-sm w-full">
                <h3 class="text-lg font-bold text-slate-800 mb-3 flex items-center gap-2">
                  <span class="text-2xl">üè•</span> 1. ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•
                </h3>

                <textarea id="scenarioInput"
                  class="w-full p-4 border border-slate-300 rounded-xl text-sm focus:ring-2 focus:ring-amber-500 outline-none mb-4 bg-white"
                  rows="6"
                  placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ì‡πå/‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå..."></textarea>

                <button id="combinedRunButton"
                  onclick="startFullAnalysis()"
                  class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-xl shadow-lg flex justify-center items-center gap-2 transform active:scale-95">
                  <span id="runSpinner" class="loader hidden border-white border-t-transparent"></span>
                  <span>üîç ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå RCA</span>
                </button>

                <div id="analyzeResult" class="hidden mt-4 p-4 text-sm text-slate-700 bg-white rounded-xl border border-amber-100 w-full"></div>
              </div>
            </div>

            <!-- ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô 2 -->
            <div class="bg-blue-50 rounded-2xl p-6 border-2 border-blue-100 shadow-md relative overflow-hidden h-full w-full">
              <div class="absolute top-0 right-0 bg-blue-200 text-blue-800 text-[10px] font-bold px-2 py-1 rounded-bl-lg">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô 2 (‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)</div>
              <h3 class="text-lg font-bold text-blue-900 mb-3 flex items-center gap-2">
                <span class="text-2xl">üéØ</span> 2. ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏•‡∏∞‡πÅ‡∏ú‡∏ô‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£
              </h3>
              <p class="text-xs text-blue-700 mb-4">
                ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á <strong>PDSA / Action Plan / Initiative Ideas / Conclusion & Recommendations</strong> ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô 4 ‡∏™‡πà‡∏ß‡∏ô
              </p>

              <label class="block text-xs font-bold text-slate-500 mb-1 uppercase">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤:</label>
              <textarea id="planInput"
                class="w-full p-4 border border-blue-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 outline-none h-24 bg-white mb-4 shadow-inner font-mono text-slate-600"
                placeholder="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏≠‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå..."></textarea>

              <div class="flex gap-2">
                <button onclick="exportToWord()"
                  class="w-full bg-white hover:bg-slate-50 text-blue-700 border border-blue-200 font-bold py-3 px-4 rounded-xl transition shadow-md flex justify-center items-center gap-2 transform active:scale-95"
                  title="‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå Word">
                  <span class="text-lg">üìÑ</span>
                  <span class="md:inline">‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô Word</span>
                </button>
              </div>

              <div class="mt-6 rounded-xl border border-blue-100 bg-white shadow-lg overflow-hidden w-full">
                <div id="planResult" class="hidden p-5 text-sm text-slate-700 min-h-[100px] w-full"></div>
              </div>
            </div>

          </div>
          <!-- /‡πÅ‡∏ú‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô -->

        </div>
      </div>

      <div class="mt-20 flex items-center justify-center">
        <div class="h-px w-24 bg-slate-300"></div>
        <span class="px-4 text-slate-400 text-sm font-semibold tracking-wider uppercase">‡∏≠‡∏á‡∏Ñ‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å</span>
        <div class="h-px w-24 bg-slate-300"></div>
      </div>
    </section>

    <section>
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold text-slate-800">1. ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡∏´‡∏•‡∏±‡∏Å</h2>
        <div class="h-1 w-20 bg-teal-500 mx-auto mt-4 rounded-full"></div>
        <p class="text-slate-600 mt-4 max-w-3xl mx-auto">
          ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à ‚Äú6 ‡πÄ‡∏™‡∏≤‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‚Äù ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤ ‚Äú‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‚Äù ‡πÅ‡∏•‡∏∞ ‚Äú‡∏à‡∏∞‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‚Äù ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏∏‡πà‡∏á‡∏ï‡∏≥‡∏´‡∏ô‡∏¥‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">

        <div class="bg-white p-8 rounded-2xl shadow-lg border-t-4 border-cyan-500 hover:shadow-xl transition group">
          <div class="flex items-center gap-3 mb-4">
            <span class="text-4xl">üêü</span>
            <h3 class="font-bold text-2xl text-slate-800">1. ‡πÅ‡∏ú‡∏ô‡∏ú‡∏±‡∏á‡∏Å‡πâ‡∏≤‡∏á‡∏õ‡∏•‡∏≤ (Ishikawa / Fishbone)</h3>
          </div>
          <p class="text-slate-600 leading-relaxed mb-6">
            ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏µ‡πà <strong>‡∏®‡∏≤‡∏™‡∏ï‡∏£‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡∏Ñ‡∏≤‡πÇ‡∏≠‡∏£‡∏∏ ‡∏≠‡∏¥‡∏ä‡∏¥‡∏Å‡∏≤‡∏ß‡∏∞ (Kaoru Ishikawa)</strong> ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ RCA ‡πÇ‡∏î‡∏¢‡πÉ‡∏ô‡∏ö‡∏£‡∏¥‡∏ö‡∏ó‡∏á‡∏≤‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏°‡∏±‡∏Å‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡∏ó‡∏µ‡πà <strong>6M</strong> ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:
          </p>

          <div class="w-full overflow-hidden bg-slate-50 rounded-xl border border-slate-200 p-2 mb-4 flex justify-center">
            <svg viewBox="0 0 800 350" class="w-full h-auto drop-shadow-sm">
              <line x1="50" y1="175" x2="650" y2="175" stroke="#334155" stroke-width="4" />
              <polygon points="650,130 790,175 650,220" fill="#0EA5E9" />
              <text x="705" y="172" font-family="sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">‡∏õ‡∏±‡∏ç‡∏´‡∏≤</text>
              <text x="705" y="195" font-family="sans-serif" font-size="12" fill="#E0F2FE" text-anchor="middle">(‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå)</text>

              <line x1="150" y1="50" x2="200" y2="175" stroke="#64748B" stroke-width="2" />
              <rect x="100" y="20" width="100" height="30" rx="5" fill="white" stroke="#64748B" />
              <text x="150" y="40" font-family="sans-serif" font-size="14" font-weight="bold" fill="#334155" text-anchor="middle">‡∏Ñ‡∏ô (Man)</text>

              <line x1="350" y1="50" x2="400" y2="175" stroke="#64748B" stroke-width="2" />
              <rect x="300" y="20" width="100" height="30" rx="5" fill="white" stroke="#64748B" />
              <text x="350" y="40" font-family="sans-serif" font-size="14" font-weight="bold" fill="#334155" text-anchor="middle">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠ (Machine)</text>

              <line x1="550" y1="50" x2="600" y2="175" stroke="#64748B" stroke-width="2" />
              <rect x="500" y="20" width="100" height="30" rx="5" fill="white" stroke="#64748B" />
              <text x="550" y="40" font-family="sans-serif" font-size="14" font-weight="bold" fill="#334155" text-anchor="middle">‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£ (Method)</text>

              <line x1="150" y1="300" x2="200" y2="175" stroke="#64748B" stroke-width="2" />
              <rect x="100" y="300" width="100" height="30" rx="5" fill="white" stroke="#64748B" />
              <text x="150" y="320" font-family="sans-serif" font-size="14" font-weight="bold" fill="#334155" text-anchor="middle">‡∏ß‡∏±‡∏™‡∏î‡∏∏ (Material)</text>

              <line x1="450" y1="300" x2="500" y2="175" stroke="#64748B" stroke-width="2" />
              <rect x="400" y="300" width="120" height="30" rx="5" fill="white" stroke="#64748B" />
              <text x="460" y="320" font-family="sans-serif" font-size="14" font-weight="bold" fill="#334155" text-anchor="middle">‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏° (Environment)</text>
            </svg>
          </div>

          <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 text-xs text-slate-600 bg-cyan-50 p-4 rounded-xl border border-cyan-100">
            <div>
              <strong class="text-cyan-800">1. ‡∏Ñ‡∏ô (Man):</strong>
              <p>‡∏™‡∏°‡∏£‡∏£‡∏ñ‡∏ô‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡πâ‡∏≤ ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÄ‡∏ß‡∏£/‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á ‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°</p>
            </div>
            <div>
              <strong class="text-cyan-800">2. ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠ (Machine):</strong>
              <p>‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∏‡∏î ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö ‡∏Å‡∏≤‡∏£‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÑ‡∏°‡πà‡∏û‡∏≠ ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏¢‡∏≤‡∏Å</p>
            </div>
            <div>
              <strong class="text-cyan-800">3. ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£ (Method):</strong>
              <p>SOP ‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏•‡πâ‡∏≤‡∏™‡∏°‡∏±‡∏¢ ‡πÇ‡∏õ‡∏£‡πÇ‡∏ï‡∏Ñ‡∏≠‡∏•‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠</p>
            </div>
            <div>
              <strong class="text-cyan-800">4. ‡∏ß‡∏±‡∏™‡∏î‡∏∏ (Material):</strong>
              <p>‡∏¢‡∏≤/‡πÄ‡∏ß‡∏ä‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏°‡∏µ‡∏ï‡∏≥‡∏´‡∏ô‡∏¥ ‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Å‡∏±‡∏ô ‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏™‡∏¥‡πâ‡∏ô‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ï‡πà‡∏≥</p>
            </div>
            <div>
              <strong class="text-cyan-800">5. ‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏° (Environment):</strong>
              <p>‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏î‡∏±‡∏á ‡πÅ‡∏™‡∏á‡∏™‡∏ß‡πà‡∏≤‡∏á ‡∏ú‡∏±‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà ‡∏™‡∏¥‡πà‡∏á‡∏£‡∏ö‡∏Å‡∏ß‡∏ô ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥</p>
            </div>
            <div>
              <strong class="text-cyan-800">6. ‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î (Measurement):</strong>
              <p>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏≤‡∏£‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏•‡∏ï‡∏£‡∏ß‡∏à ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î</p>
            </div>
          </div>
        </div>

        <div class="bg-white p-8 rounded-2xl shadow-lg border-t-4 border-pink-500 hover:shadow-xl transition group">
          <div class="flex items-center gap-3 mb-4">
            <span class="text-4xl">‚ùì</span>
            <h3 class="font-bold text-2xl text-slate-800">2. ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ó‡∏≥‡πÑ‡∏°-‡∏ó‡∏≥‡πÑ‡∏° (5 Whys)</h3>
          </div>
          <p class="text-slate-600 leading-relaxed mb-4">
            ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà <strong>‡∏ã‡∏≤‡∏Ñ‡∏¥‡∏à‡∏¥ ‡πÇ‡∏ï‡πÇ‡∏¢‡∏î‡∏∞ (Sakichi Toyoda)</strong> (‡πÇ‡∏ï‡πÇ‡∏¢‡∏ï‡πâ‡∏≤) ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏∂‡∏Å‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏à‡∏≤‡∏Å‡∏Å‡πâ‡∏≤‡∏á‡∏õ‡∏•‡∏≤ ‡πÇ‡∏î‡∏¢‡∏ñ‡∏≤‡∏° ‚Äú‡∏ó‡∏≥‡πÑ‡∏°?‚Äù ‡∏ã‡πâ‡∏≥ 5 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‚Äú‡∏£‡∏≤‡∏Å‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πâ‡∏à‡∏£‡∏¥‡∏á‚Äù
          </p>
          <div class="bg-pink-50 p-4 rounded-lg border border-pink-100">
            <strong class="text-pink-800 block mb-2 text-sm">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏´‡∏Å‡∏•‡πâ‡∏°</strong>
            <div class="space-y-0">
              <div class="why-step">
                <div class="why-number">1</div><div class="why-line"></div>
                <div class="text-sm text-slate-700 pt-1">‡∏ó‡∏≥‡πÑ‡∏°? ‡∏û‡∏∑‡πâ‡∏ô‡πÄ‡∏õ‡∏µ‡∏¢‡∏Å</div>
              </div>
              <div class="why-step">
                <div class="why-number">2</div><div class="why-line"></div>
                <div class="text-sm text-slate-700 pt-1">‡∏ó‡∏≥‡πÑ‡∏°? ‡∏ó‡πà‡∏≠‡∏ô‡πâ‡∏≥‡∏£‡∏±‡πà‡∏ß</div>
              </div>
              <div class="why-step">
                <div class="why-number">3</div><div class="why-line"></div>
                <div class="text-sm text-slate-700 pt-1">‡∏ó‡∏≥‡πÑ‡∏°? ‡∏ã‡∏µ‡∏•‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°/‡πÅ‡∏ï‡∏Å</div>
              </div>
              <div class="why-step">
                <div class="why-number">4</div><div class="why-line"></div>
                <div class="text-sm text-slate-700 pt-1">‡∏ó‡∏≥‡πÑ‡∏°? ‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏ã‡∏µ‡∏•‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ñ‡∏π‡∏Å</div>
              </div>
              <div class="why-step">
                <div class="why-number">5</div>
                <div class="text-sm text-slate-700 pt-1 font-bold text-pink-700">‡∏£‡∏≤‡∏Å‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏: ‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Å‡∏±‡∏ö‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û</div>
              </div>
            </div>
          </div>
        </div>

        <div class="bg-white p-8 rounded-2xl shadow-lg border-t-4 border-green-600 hover:shadow-xl transition group">
          <div class="flex items-center gap-3 mb-4">
            <span class="text-4xl">üéÑ</span>
            <h3 class="font-bold text-2xl text-slate-800">3. ‡πÅ‡∏ú‡∏ô‡∏ú‡∏±‡∏á‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á (FTA)</h3>
          </div>
          <p class="text-xs text-slate-500 mb-3">‡∏ó‡∏≥‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß‡πÄ‡∏ä‡∏¥‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡πÅ‡∏•‡∏∞‡∏ú‡∏•</p>
          <div class="bg-green-50 p-6 rounded-xl border border-green-200 flex flex-col items-center overflow-x-auto">
            <div class="bg-red-500 text-white px-4 py-2 rounded-lg font-bold text-sm shadow-md z-10 text-center">...‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ö‡∏ô (‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ì‡πå)...</div>
            <div class="h-6 w-0.5 bg-slate-400"></div>
            <div class="bg-slate-800 text-white text-[10px] px-2 py-0.5 rounded z-10 relative">OR Gate</div>
            <div class="h-4 w-0.5 bg-slate-400"></div>
            <div class="w-64 h-0.5 bg-slate-400"></div>
            <div class="flex justify-between w-full max-w-md gap-4">
              <div class="flex flex-col items-center w-1/2">
                <div class="h-4 w-0.5 bg-slate-400"></div>
                <div class="bg-white border-2 border-green-500 text-green-800 px-3 py-2 rounded-lg text-xs font-bold shadow-sm text-center">...‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á A...</div>
              </div>
              <div class="flex flex-col items-center w-1/2">
                <div class="h-4 w-0.5 bg-slate-400"></div>
                <div class="bg-blue-600 text-white text-[10px] px-2 py-0.5 rounded z-10 relative">AND Gate</div>
                <div class="h-4 w-0.5 bg-slate-400"></div>
                <div class="w-24 h-0.5 bg-slate-400"></div>
                <div class="flex justify-between w-full gap-2">
                  <div class="flex flex-col items-center">
                    <div class="h-3 w-0.5 bg-slate-400"></div>
                    <div class="bg-white border border-green-500 text-green-700 px-2 py-1 rounded text-[10px] text-center">...‡∏£‡∏≤‡∏Å‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏ 1...</div>
                  </div>
                  <div class="flex flex-col items-center">
                    <div class="h-3 w-0.5 bg-slate-400"></div>
                    <div class="bg-white border border-green-500 text-green-700 px-2 py-1 rounded text-[10px] text-center">...‡∏£‡∏≤‡∏Å‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏ 2...</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="bg-white p-8 rounded-2xl shadow-lg border-t-4 border-amber-500 hover:shadow-xl transition group">
          <div class="flex items-center gap-3 mb-4">
            <span class="text-4xl">üßÄ</span>
            <h3 class="font-bold text-2xl text-slate-800">4. ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏™‡∏ß‡∏¥‡∏™‡∏ä‡∏µ‡∏™ (Swiss Cheese Model)</h3>
          </div>
          <p class="text-slate-600 leading-relaxed mb-6">
            <strong>‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏Ç‡∏≠‡∏á James Reason:</strong> ‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠ ‚Äú‡∏£‡∏π‚Äù (‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà) ‡πÉ‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡∏ä‡∏±‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏±‡∏ß‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô ‡∏ó‡∏≥‡πÉ‡∏´‡πâ ‚Äú‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‚Äù ‡∏ó‡∏∞‡∏•‡∏∏‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏õ‡∏à‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢
          </p>

          <div class="w-full overflow-hidden bg-slate-50 rounded-xl border border-slate-200 p-6 mb-6 flex justify-center">
            <svg viewBox="0 0 800 320" class="w-full h-auto drop-shadow-sm">
              <defs>
                <marker id="arrowRed" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                  <polygon points="0 0, 10 3.5, 0 7" fill="#EF4444" />
                </marker>
              </defs>
              <line x1="50" y1="140" x2="720" y2="140" stroke="#EF4444" stroke-width="4" stroke-dasharray="10,5" marker-end="url(#arrowRed)" />
              <text x="50" y="120" font-family="sans-serif" font-size="14" font-weight="bold" fill="#EF4444">‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢ (Hazard)</text>

              <g transform="translate(150, 40)">
                <rect x="0" y="0" width="70" height="200" rx="4" fill="#FEF3C7" stroke="#334155" stroke-width="2" />
                <circle cx="35" cy="40" r="10" fill="white" stroke="#334155" stroke-width="1" />
                <circle cx="20" cy="180" r="8" fill="white" stroke="#334155" stroke-width="1" />
                <circle cx="35" cy="100" r="15" fill="white" stroke="#EF4444" stroke-width="2" stroke-dasharray="4,2" />
                <text x="35" y="230" font-family="sans-serif" font-size="12" font-weight="bold" fill="#334155" text-anchor="middle">‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</text>
              </g>

              <g transform="translate(300, 40)">
                <rect x="0" y="0" width="70" height="200" rx="4" fill="#FDE68A" stroke="#334155" stroke-width="2" />
                <circle cx="20" cy="50" r="9" fill="white" stroke="#334155" stroke-width="1" />
                <circle cx="50" cy="160" r="11" fill="white" stroke="#334155" stroke-width="1" />
                <circle cx="35" cy="100" r="15" fill="white" stroke="#EF4444" stroke-width="2" stroke-dasharray="4,2" />
                <text x="35" y="230" font-family="sans-serif" font-size="12" font-weight="bold" fill="#334155" text-anchor="middle">‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£/‡∏Å‡∏≥‡∏Å‡∏±‡∏ö</text>
              </g>

              <g transform="translate(450, 40)">
                <rect x="0" y="0" width="70" height="200" rx="4" fill="#FCD34D" stroke="#334155" stroke-width="2" />
                <circle cx="45" cy="30" r="8" fill="white" stroke="#334155" stroke-width="1" />
                <circle cx="25" cy="170" r="10" fill="white" stroke="#334155" stroke-width="1" />
                <circle cx="35" cy="100" r="15" fill="white" stroke="#EF4444" stroke-width="2" stroke-dasharray="4,2" />
                <text x="35" y="230" font-family="sans-serif" font-size="12" font-weight="bold" fill="#334155" text-anchor="middle">‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°</text>
              </g>

              <g transform="translate(600, 40)">
                <rect x="0" y="0" width="70" height="200" rx="4" fill="#F59E0B" stroke="#334155" stroke-width="2" />
                <circle cx="20" cy="60" r="12" fill="white" stroke="#334155" stroke-width="1" />
                <circle cx="50" cy="150" r="9" fill="white" stroke="#334155" stroke-width="1" />
                <circle cx="35" cy="100" r="15" fill="white" stroke="#EF4444" stroke-width="2" stroke-dasharray="4,2" />
                <text x="35" y="230" font-family="sans-serif" font-size="12" font-weight="bold" fill="#334155" text-anchor="middle">‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô</text>
              </g>

              <g transform="translate(740, 140)">
                <path d="M0 -20 L5 -5 L20 0 L5 5 L0 20 L-5 5 L-20 0 L-5 -5 Z" fill="#EF4444" stroke="#991B1B" stroke-width="2" />
                <text x="0" y="40" font-family="sans-serif" font-size="14" font-weight="bold" fill="#EF4444" text-anchor="middle">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢</text>
              </g>
            </svg>
          </div>

          <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 text-xs text-slate-600 bg-amber-50 p-4 rounded-xl border border-amber-100">
            <div>
              <strong class="text-amber-800">1. ‡∏≠‡∏¥‡∏ó‡∏ò‡∏¥‡∏û‡∏•‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£:</strong>
              <p>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡∏£‡∏£‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£ ‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ ‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢/‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á</p>
            </div>
            <div>
              <strong class="text-amber-800">2. ‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢:</strong>
              <p>‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°‡πÑ‡∏°‡πà‡∏û‡∏≠ ‡∏à‡∏±‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏á‡∏≤‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏° ‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ñ‡πâ‡∏≤‡∏á</p>
            </div>
            <div>
              <strong class="text-amber-800">3. ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏:</strong>
              <p>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡πâ‡∏≤ ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î ‡∏†‡∏≤‡∏£‡∏∞‡∏á‡∏≤‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÑ‡∏°‡πà‡πÄ‡∏≠‡∏∑‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</p>
            </div>
            <div>
              <strong class="text-amber-800">4. ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢:</strong>
              <p>‡πÄ‡∏ú‡∏•‡∏≠ ‡∏•‡∏∑‡∏° ‡∏ó‡∏≥‡∏ú‡∏¥‡∏î ‡∏´‡∏£‡∏∑‡∏≠‡∏ù‡πà‡∏≤‡∏ù‡∏∑‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô</p>
            </div>
          </div>
        </div>

        <div class="bg-white p-8 rounded-2xl shadow-lg border-t-4 border-teal-500 hover:shadow-xl transition group">
          <div class="flex items-center gap-3 mb-4">
            <span class="text-4xl">‚öñÔ∏è</span>
            <h3 class="font-bold text-2xl text-slate-800">5. ‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏¢‡∏∏‡∏ï‡∏¥‡∏ò‡∏£‡∏£‡∏° (Just Culture)</h3>
          </div>
          <p class="text-slate-600 leading-relaxed mb-4">
            ‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏¢‡∏∏‡∏ï‡∏¥‡∏ò‡∏£‡∏£‡∏°‡πÅ‡∏¢‡∏Å‡πÅ‡∏¢‡∏∞‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô 3 ‡∏Å‡∏•‡∏∏‡πà‡∏° (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÇ‡∏î‡∏¢‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå / ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á / ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏°‡∏∏‡∏ó‡∏∞‡∏•‡∏∏) ‡πÅ‡∏•‡∏∞‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°
          </p>
          <div class="overflow-x-auto">
            <table class="w-full text-sm text-left text-slate-600 border border-slate-200 rounded-lg">
              <thead class="bg-slate-100 text-slate-700 font-bold">
                <tr>
                  <th class="p-2 border-b">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°</th>
                  <th class="p-2 border-b">‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á/‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                </tr>
              </thead>
              <tbody>
                <tr class="border-b bg-green-50">
                  <td class="p-2 font-bold text-green-700">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÇ‡∏î‡∏¢‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå (Human Error)</td>
                  <td class="p-2">‡∏õ‡∏•‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡∏Ñ‡∏≠‡∏á/‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô (Console)</td>
                </tr>
                <tr class="border-b bg-yellow-50">
                  <td class="p-2 font-bold text-yellow-700">‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á (At-Risk Behavior)</td>
                  <td class="p-2">‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ/‡πÇ‡∏Ñ‡πâ‡∏ä (Coach)</td>
                </tr>
                <tr class="bg-red-50">
                  <td class="p-2 font-bold text-red-700">‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏°‡∏∏‡∏ó‡∏∞‡∏•‡∏∏ (Reckless Behavior)</td>
                  <td class="p-2">‡∏ß‡∏¥‡∏ô‡∏±‡∏¢/‡∏•‡∏á‡πÇ‡∏ó‡∏© (Punish)</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="bg-white p-8 rounded-2xl shadow-lg border-t-4 border-blue-500 hover:shadow-xl transition group">
          <div class="flex items-center gap-3 mb-4">
            <span class="text-4xl">üìê</span>
            <h3 class="font-bold text-2xl text-slate-800">6. ‡∏Å‡∏≤‡∏£‡∏¢‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå (HFE)</h3>
          </div>
          <p class="text-slate-600 leading-relaxed mb-4">
            ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏° ‚Äú‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡∏ô‚Äù (‡∏ã‡∏∂‡πà‡∏á‡∏¢‡πà‡∏≠‡∏°‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÑ‡∏î‡πâ) <strong>HFE</strong> ‡πÄ‡∏ô‡πâ‡∏ô‡∏Å‡∏≤‡∏£ <strong>‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏£‡∏∞‡∏ö‡∏ö ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå ‡πÅ‡∏•‡∏∞‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</strong> ‡πÉ‡∏´‡πâ‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ç‡∏≠‡∏á‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå
          </p>

          <div class="bg-blue-50 p-5 rounded-xl border border-blue-100 text-sm">
            <strong class="text-blue-800 block mb-3 text-base">‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå‡πÄ‡∏ä‡∏¥‡∏á‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:</strong>
            <ul class="space-y-3">
              <li class="flex items-start gap-3">
                <div class="bg-white p-1 rounded border border-blue-200 shadow-sm text-lg">üîí</div>
                <div>
                  <strong class="text-slate-700">‡∏Å‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÄ‡∏ä‡∏¥‡∏á‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö (Forcing Functions)</strong>
                  <p class="text-slate-500 text-xs mt-0.5">‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡πâ ‚Äú‡∏ó‡∏≥‡∏ú‡∏¥‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‚Äù (‡πÄ‡∏ä‡πà‡∏ô ‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡∏Ñ‡∏ô‡∏•‡∏∞‡∏û‡∏≠‡∏£‡πå‡∏ï‡πÄ‡∏™‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û)</p>
                </div>
              </li>
              <li class="flex items-start gap-3">
                <div class="bg-white p-1 rounded border border-blue-200 shadow-sm text-lg">üìè</div>
                <div>
                  <strong class="text-slate-700">‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô (Standardization)</strong>
                  <p class="text-slate-500 text-xs mt-0.5">‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå/‡∏ú‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ß‡∏≤‡∏á‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô (‡πÄ‡∏ä‡πà‡∏ô ‡∏£‡∏ñ‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô‡∏à‡∏±‡∏î‡∏ß‡∏≤‡∏á‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡∏à‡∏∏‡∏î) ‡∏•‡∏î‡∏†‡∏≤‡∏£‡∏∞‡∏Å‡∏≤‡∏£‡∏Ñ‡∏¥‡∏î</p>
                </div>
              </li>
              <li class="flex items-start gap-3">
                <div class="bg-white p-1 rounded border border-blue-200 shadow-sm text-lg">üîä</div>
                <div>
                  <strong class="text-slate-700">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</strong>
                  <p class="text-slate-500 text-xs mt-0.5">‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏ö‡∏™‡∏ô‡πÉ‡∏ô‡∏†‡∏≤‡∏ß‡∏∞‡∏Å‡∏î‡∏î‡∏±‡∏ô</p>
                </div>
              </li>
            </ul>
          </div>
        </div>

        <div class="bg-white p-8 rounded-2xl shadow-lg border-t-4 border-indigo-600 hover:shadow-xl transition group">
          <div class="flex items-center gap-3 mb-4">
            <span class="text-4xl">üß©</span>
            <h3 class="font-bold text-2xl text-slate-800">7. ‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡πÄ‡∏≠‡∏∑‡πâ‡∏≠/‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏£‡πà‡∏ß‡∏° (Contributing Factors)</h3>
          </div>
          <p class="text-slate-600 leading-relaxed mb-6">
            ‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÅ‡∏ù‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¥‡∏ó‡∏ò‡∏¥‡∏û‡∏•‡∏ï‡πà‡∏≠‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå ‡πÅ‡∏°‡πâ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà ‚Äú‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‚Äù ‡πÅ‡∏ï‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÄ‡∏Å‡∏¥‡∏î‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô
          </p>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="bg-indigo-50 p-4 rounded-xl border border-indigo-100">
              <strong class="text-indigo-800 flex items-center gap-2">
                <i class="fas fa-user-injured"></i> ‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏î‡πâ‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢
              </strong>
              <p class="text-xs text-slate-600 mt-2">‡∏†‡∏≤‡∏ß‡∏∞‡∏ó‡∏≤‡∏á‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô ‡∏≠‡∏∏‡∏õ‡∏™‡∏£‡∏£‡∏Ñ‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£ ‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏ó‡∏≤‡∏á‡∏™‡∏±‡∏á‡∏Ñ‡∏°</p>
            </div>

            <div class="bg-indigo-50 p-4 rounded-xl border border-indigo-100">
              <strong class="text-indigo-800 flex items-center gap-2">
                <i class="fas fa-tasks"></i> ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ
              </strong>
              <p class="text-xs text-slate-600 mt-2">‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÇ‡∏õ‡∏£‡πÇ‡∏ï‡∏Ñ‡∏≠‡∏• ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡∏≠‡∏á‡∏ú‡∏•‡∏ï‡∏£‡∏ß‡∏à ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</p>
            </div>

            <div class="bg-indigo-50 p-4 rounded-xl border border-indigo-100">
              <strong class="text-indigo-800 flex items-center gap-2">
                <i class="fas fa-user-nurse"></i> ‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏£‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•
              </strong>
              <p class="text-xs text-slate-600 mt-2">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ ‡∏ó‡∏±‡∏Å‡∏©‡∏∞ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡πâ‡∏≤ ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏¢</p>
            </div>

            <div class="bg-indigo-50 p-4 rounded-xl border border-indigo-100">
              <strong class="text-indigo-800 flex items-center gap-2">
                <i class="fas fa-users"></i> ‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏ó‡∏µ‡∏°
              </strong>
              <p class="text-xs text-slate-600 mt-2">‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡∏ó‡∏≤‡∏á‡∏ß‡∏≤‡∏à‡∏≤ ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å ‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏î‡∏π‡πÅ‡∏• ‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠</p>
            </div>

            <div class="bg-indigo-50 p-4 rounded-xl border border-indigo-100">
              <strong class="text-indigo-800 flex items-center gap-2">
                <i class="fas fa-hospital"></i> ‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
              </strong>
              <p class="text-xs text-slate-600 mt-2">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á ‡∏†‡∏≤‡∏£‡∏∞‡∏á‡∏≤‡∏ô ‡πÄ‡∏™‡∏µ‡∏¢‡∏á ‡πÅ‡∏™‡∏á ‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£</p>
            </div>

            <div class="bg-indigo-50 p-4 rounded-xl border border-indigo-100">
              <strong class="text-indigo-800 flex items-center gap-2">
                <i class="fas fa-sitemap"></i> ‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£
              </strong>
              <p class="text-xs text-slate-600 mt-2">‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢ ‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏î‡πâ‡∏≤‡∏ô‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</p>
            </div>
          </div>
        </div>

        <div class="bg-white p-8 rounded-2xl shadow-lg border-t-4 border-rose-500 hover:shadow-xl transition group">
          <div class="flex items-center gap-3 mb-4">
            <span class="text-4xl">üîÆ</span>
            <h3 class="font-bold text-2xl text-slate-800">8. FMEA (‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤)</h3>
          </div>
          <p class="text-slate-600 leading-relaxed mb-4">
            <strong>Failure Mode and Effects Analysis:</strong> ‡∏´‡∏≤‡∏Å RCA ‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£ ‚Äú‡∏°‡∏≠‡∏á‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‚Äù ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÉ‡∏ô‡∏≠‡∏î‡∏µ‡∏ï FMEA ‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£ ‚Äú‡∏°‡∏≠‡∏á‡πÑ‡∏õ‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‚Äù ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß‡πÅ‡∏•‡∏∞‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏Å‡∏¥‡∏î
          </p>

          <div class="bg-rose-50 border-l-4 border-rose-500 p-4 mb-6 rounded-r-lg">
            <strong class="text-rose-700 text-sm uppercase tracking-wide">üöÄ ‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠:</strong>
            <p class="text-rose-800 text-sm mt-1">
              ‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÅ‡∏ú‡∏ô‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà (<strong>‡∏´‡∏•‡∏±‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô 2</strong>) ‡πÅ‡∏•‡∏∞‡∏Å‡πà‡∏≠‡∏ô‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ú‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ FMEA ‡πÄ‡∏õ‡πá‡∏ô ‚Äú‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏ô‡∏ó‡∏≤‡∏ô‚Äù ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
            </p>
          </div>

          <div class="bg-white border border-rose-100 rounded-xl p-4 shadow-sm">
            <div class="text-center mb-3">
              <span class="text-xs font-bold text-slate-400 uppercase">‡∏™‡∏π‡∏ï‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á (RPN)</span>
            </div>
            <div class="flex flex-wrap justify-center items-center gap-2 md:gap-4 text-center">
              <div class="bg-rose-100 p-3 rounded-lg w-24">
                <div class="text-2xl font-bold text-rose-600">S</div>
                <div class="text-[10px] text-rose-800 font-bold mt-1">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á</div>
                <div class="text-[9px] text-rose-600">(‡∏£‡πâ‡∏≤‡∏¢‡πÅ‡∏£‡∏á‡πÅ‡∏Ñ‡πà‡πÑ‡∏´‡∏ô)</div>
              </div>

              <div class="text-slate-300 text-xl">‚úñ</div>

              <div class="bg-rose-100 p-3 rounded-lg w-24">
                <div class="text-2xl font-bold text-rose-600">O</div>
                <div class="text-[10px] text-rose-800 font-bold mt-1">‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÄ‡∏Å‡∏¥‡∏î</div>
                <div class="text-[9px] text-rose-600">(‡πÄ‡∏Å‡∏¥‡∏î‡∏ö‡πà‡∏≠‡∏¢‡πÅ‡∏Ñ‡πà‡πÑ‡∏´‡∏ô)</div>
              </div>

              <div class="text-slate-300 text-xl">‚úñ</div>

              <div class="bg-rose-100 p-3 rounded-lg w-24">
                <div class="text-2xl font-bold text-rose-600">D</div>
                <div class="text-[10px] text-rose-800 font-bold mt-1">‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏¢‡∏≤‡∏Å</div>
                <div class="text-[9px] text-rose-600">(‡∏à‡∏∞‡∏£‡∏π‡πâ‡∏ï‡∏±‡∏ß‡∏ó‡∏±‡∏ô‡πÑ‡∏´‡∏°)</div>
              </div>

              <div class="text-slate-400 text-xl">=</div>

              <div class="bg-slate-800 p-3 rounded-lg w-28 shadow-md">
                <div class="text-2xl font-bold text-white">RPN</div>
                <div class="text-[10px] text-slate-300 mt-1">‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á</div>
              </div>
            </div>
          </div>
        </div>

      </div>
    </section>

    <section class="bg-white rounded-3xl shadow-xl p-8 md:p-12 border border-slate-200">
      <div class="grid grid-cols-1 lg:grid-cols-12 gap-12">
        <div class="lg:col-span-5 space-y-6">
          <h2 class="text-3xl font-bold text-slate-800">2. ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</h2>
          <div class="h-1 w-20 bg-teal-500 rounded-full"></div>
          <p class="text-slate-600 leading-relaxed font-light italic border-l-4 border-teal-500 pl-4 bg-teal-50/50 p-2 rounded-r-lg">
            ‚Äú‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á <strong>AHRQ HSOPSC 2.0</strong> (10 ‡∏°‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô) ‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏≠‡∏Å <strong>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏ö‡∏ß‡∏Å (%)</strong> ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏°‡∏¥‡∏ï‡∏¥ ‡∏Å‡∏£‡∏≤‡∏ü‡∏à‡∏∞‡∏ä‡∏µ‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ (100%)‚Äù
          </p>

          <div class="bg-slate-100 p-4 rounded-xl border border-slate-200 max-h-[500px] overflow-y-auto">
            <h4 class="text-xs font-bold text-slate-500 uppercase mb-3 tracking-wide flex items-center gap-2 sticky top-0 bg-slate-100 py-2 border-b">
              <span>üéöÔ∏è</span> ‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏ö‡∏ß‡∏Å (%)
            </h4>
            <div class="space-y-4 text-sm">
              <div>
                <div class="flex justify-between mb-1">
                  <label class="text-slate-700 font-semibold text-xs">1. ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡∏°</label>
                  <span id="val-0" class="text-teal-600 font-bold text-xs">0.00%</span>
                </div>
                <input type="range" min="0" max="100" step="0.01" value="0"
                  class="w-full h-2 bg-slate-300 rounded-lg appearance-none cursor-pointer accent-teal-500"
                  oninput="updateChartData(0, this.value)">
              </div>

              <div>
                <div class="flex justify-between mb-1">
                  <label class="text-slate-700 font-semibold text-xs">2. ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏á‡∏≤‡∏ô</label>
                  <span id="val-1" class="text-teal-600 font-bold text-xs">0.00%</span>
                </div>
                <input type="range" min="0" max="100" step="0.01" value="0"
                  class="w-full h-2 bg-slate-300 rounded-lg appearance-none cursor-pointer accent-teal-500"
                  oninput="updateChartData(1, this.value)">
              </div>

              <div>
                <div class="flex justify-between mb-1">
                  <label class="text-slate-700 font-semibold text-xs">3. ‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Ç‡∏≠‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</label>
                  <span id="val-2" class="text-teal-600 font-bold text-xs">0.00%</span>
                </div>
                <input type="range" min="0" max="100" step="0.01" value="0"
                  class="w-full h-2 bg-slate-300 rounded-lg appearance-none cursor-pointer accent-teal-500"
                  oninput="updateChartData(2, this.value)">
              </div>

              <div>
                <div class="flex justify-between mb-1">
                  <label class="text-slate-700 font-semibold text-xs">4. ‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏ï‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î</label>
                  <span id="val-3" class="text-teal-600 font-bold text-xs">0.00%</span>
                </div>
                <input type="range" min="0" max="100" step="0.01" value="0"
                  class="w-full h-2 bg-slate-300 rounded-lg appearance-none cursor-pointer accent-teal-500"
                  oninput="updateChartData(3, this.value)">
              </div>

              <div>
                <div class="flex justify-between mb-1">
                  <label class="text-slate-700 font-semibold text-xs">5. ‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏à‡∏≤‡∏Å‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô</label>
                  <span id="val-4" class="text-teal-600 font-bold text-xs">0.00%</span>
                </div>
                <input type="range" min="0" max="100" step="0.01" value="0"
                  class="w-full h-2 bg-slate-300 rounded-lg appearance-none cursor-pointer accent-teal-500"
                  oninput="updateChartData(4, this.value)">
              </div>

              <div>
                <div class="flex justify-between mb-1">
                  <label class="text-slate-700 font-semibold text-xs">6. ‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î</label>
                  <span id="val-5" class="text-teal-600 font-bold text-xs">0.00%</span>
                </div>
                <input type="range" min="0" max="100" step="0.01" value="0"
                  class="w-full h-2 bg-slate-300 rounded-lg appearance-none cursor-pointer accent-teal-500"
                  oninput="updateChartData(5, this.value)">
              </div>

              <div>
                <div class="flex justify-between mb-1">
                  <label class="text-slate-700 font-semibold text-xs">7. ‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏ß‡πâ‡∏≤‡∏á</label>
                  <span id="val-6" class="text-teal-600 font-bold text-xs">0.00%</span>
                </div>
                <input type="range" min="0" max="100" step="0.01" value="0"
                  class="w-full h-2 bg-slate-300 rounded-lg appearance-none cursor-pointer accent-teal-500"
                  oninput="updateChartData(6, this.value)">
              </div>

              <div>
                <div class="flex justify-between mb-1">
                  <label class="text-slate-700 font-semibold text-xs">8. ‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</label>
                  <span id="val-7" class="text-teal-600 font-bold text-xs">0.00%</span>
                </div>
                <input type="range" min="0" max="100" step="0.01" value="0"
                  class="w-full h-2 bg-slate-300 rounded-lg appearance-none cursor-pointer accent-teal-500"
                  oninput="updateChartData(7, this.value)">
              </div>

              <div>
                <div class="flex justify-between mb-1">
                  <label class="text-slate-700 font-semibold text-xs">9. ‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•</label>
                  <span id="val-8" class="text-teal-600 font-bold text-xs">0.00%</span>
                </div>
                <input type="range" min="0" max="100" step="0.01" value="0"
                  class="w-full h-2 bg-slate-300 rounded-lg appearance-none cursor-pointer accent-teal-500"
                  oninput="updateChartData(8, this.value)">
              </div>

              <div>
                <div class="flex justify-between mb-1">
                  <label class="text-slate-700 font-semibold text-xs">10. ‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡πÄ‡∏ß‡∏£‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</label>
                  <span id="val-9" class="text-teal-600 font-bold text-xs">0.00%</span>
                </div>
                <input type="range" min="0" max="100" step="0.01" value="0"
                  class="w-full h-2 bg-slate-300 rounded-lg appearance-none cursor-pointer accent-teal-500"
                  oninput="updateChartData(9, this.value)">
              </div>
            </div>
          </div>

          <div class="chart-container mt-6">
            <canvas id="assessmentChart"></canvas>
          </div>
          <p class="text-xs text-center text-slate-400 mt-2">‡πÄ‡∏ä‡∏¥‡∏á‡πÇ‡∏ï‡πâ‡∏ï‡∏≠‡∏ö: ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ 100%</p>
        </div>

        <div class="lg:col-span-7 space-y-6">
          <h3 class="xl font-bold text-slate-700 border-l-4 border-teal-500 pl-4">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</h3>
          <div class="space-y-4">
            <div class="bg-slate-50 p-4 rounded-xl border border-slate-200">
              <div class="flex items-start gap-3">
                <div class="bg-red-100 text-red-600 p-2 rounded-lg font-bold text-xl">‚ö†Ô∏è</div>
                <div>
                  <h4 class="font-bold text-slate-800">‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏ï‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏•‡∏á‡πÇ‡∏ó‡∏©</h4>
                  <p class="text-sm text-slate-600 mt-1"><strong>‡∏õ‡∏±‡∏ç‡∏´‡∏≤:</strong> ‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£‡∏Å‡∏•‡∏±‡∏ß‡∏Å‡∏≤‡∏£‡∏ñ‡∏π‡∏Å‡∏•‡∏á‡πÇ‡∏ó‡∏©‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏Å‡∏õ‡∏¥‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á</p>
                  <div class="mt-3 bg-white p-3 rounded border border-slate-200 text-sm">
                    <strong class="text-teal-600">‚úÖ ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:</strong>
                    <ul class="list-disc list-inside text-slate-500 mt-1">
                      <li>‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢ ‚Äú‡πÑ‡∏°‡πà‡πÇ‡∏ó‡∏©‡∏Å‡∏±‡∏ô‚Äù ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô</li>
                      <li>‡∏ó‡∏≥ <strong>‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö‡πÅ‡∏ó‡∏ô‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ (Substitution Test)</strong> (‡∏´‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á‡∏Å‡πá‡∏°‡∏µ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏û‡∏•‡∏≤‡∏î‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô ‚Üí ‡∏°‡∏±‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏ä‡∏¥‡∏á‡∏£‡∏∞‡∏ö‡∏ö)</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>

            <div class="bg-slate-50 p-4 rounded-xl border border-slate-200">
              <div class="flex items-start gap-3">
                <div class="bg-amber-100 text-amber-600 p-2 rounded-lg font-bold text-xl">‚ö°</div>
                <div>
                  <h4 class="font-bold text-slate-800">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏•‡∏∞‡∏†‡∏≤‡∏£‡∏∞‡∏á‡∏≤‡∏ô</h4>
                  <p class="text-sm text-slate-600 mt-1"><strong>‡∏õ‡∏±‡∏ç‡∏´‡∏≤:</strong> ‡∏†‡∏≤‡∏£‡∏∞‡∏á‡∏≤‡∏ô‡∏°‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏•‡πâ‡∏≤ ‡πÅ‡∏•‡∏∞‡πÄ‡∏≠‡∏∑‡πâ‡∏≠‡∏ï‡πà‡∏≠ ‚Äú‡∏ó‡∏≤‡∏á‡∏•‡∏±‡∏î‚Äù (‡∏Ç‡πâ‡∏≤‡∏°‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô) ‡∏à‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á</p>
                  <div class="mt-3 bg-white p-3 rounded border border-slate-200 text-sm">
                    <strong class="text-teal-600">‚úÖ ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:</strong>
                    <ul class="list-disc list-inside text-slate-500 mt-1">
                      <li>‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏£‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏° (‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏ß‡∏£‡∏ã‡πâ‡∏≠‡∏ô/‡∏î‡∏±‡∏ö‡πÄ‡∏ö‡∏¥‡∏•‡∏ä‡∏¥‡∏ü‡∏ï‡πå)</li>
                      <li>‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ä‡πà‡∏ß‡∏¢‡∏•‡∏î‡∏á‡∏≤‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </section>

    <section class="py-8">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold text-slate-800">3. ‡πÇ‡∏£‡∏î‡πÅ‡∏°‡∏õ‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ</h2>
        <div class="h-1 w-20 bg-blue-500 mx-auto mt-4 rounded-full"></div>
        <p class="text-slate-600 mt-4">‡πÅ‡∏ú‡∏ô 3 ‡∏£‡∏∞‡∏¢‡∏∞ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</p>
      </div>

      <div class="relative max-w-5xl mx-auto pl-8 md:pl-0">
        <div class="timeline-line hidden md:block" style="left: 50%; transform: translateX(-50%);"></div>

        <div class="relative grid grid-cols-1 md:grid-cols-2 gap-8 mb-16">
          <div class="md:text-right md:pr-12 order-1">
            <div class="bg-white p-6 rounded-2xl shadow-lg border-t-4 border-teal-500 relative">
              <h3 class="text-xl font-bold text-teal-700">‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏µ‡πà 1: ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏ß‡πâ‡∏ß‡∏≤‡∏á‡πÉ‡∏à</h3>
              <span class="text-xs font-bold text-slate-400 uppercase tracking-wide">‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤: ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1-3</span>
              <p class="text-sm text-slate-600 mt-3 leading-relaxed">
                ‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏ô‡∏≥‡πÅ‡∏•‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£ ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏ó‡∏ô‡∏≤‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‚Äú‡πÄ‡∏õ‡∏¥‡∏î‚Äù ‡πÅ‡∏•‡∏∞ ‚Äú‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‚Äù
              </p>
              <div class="mt-4 pt-4 border-t border-slate-100 text-left">
                <strong class="text-sm text-slate-700 block mb-2">üöÄ ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏•‡∏±‡∏Å:</strong>
                <ul class="text-sm text-slate-600 space-y-2">
                  <li>üîπ <strong>Safety Walkround ‡πÇ‡∏î‡∏¢‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£:</strong> ‡∏ú‡∏π‡πâ‡∏ô‡∏≥‡∏•‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠ ‚Äú‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‚Äù ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ ‚Äú‡∏™‡∏±‡πà‡∏á‡∏Å‡∏≤‡∏£‚Äù</li>
                  <li>üîπ <strong>‡πÅ‡∏Ñ‡∏°‡πÄ‡∏õ‡∏ç‡πÄ‡∏•‡∏¥‡∏Å‡∏ï‡∏≤‡∏°‡∏´‡∏≤‡∏Ñ‡∏ô‡∏ú‡∏¥‡∏î:</strong> ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å ‚Äú‡πÉ‡∏Ñ‡∏£‚Äù ‡πÄ‡∏õ‡πá‡∏ô ‚Äú‡∏≠‡∏∞‡πÑ‡∏£ (‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö)‚Äù</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="absolute left-0 md:left-1/2 -translate-x-1/2 top-6 w-10 h-10 bg-teal-500 rounded-full border-4 border-white shadow-md z-10 flex items-center justify-center text-white font-bold">1</div>
          <div class="hidden md:block order-2"></div>
        </div>

        <div class="relative grid grid-cols-1 md:grid-cols-2 gap-8 mb-16">
          <div class="hidden md:block order-1"></div>
          <div class="absolute left-0 md:left-1/2 -translate-x-1/2 top-6 w-10 h-10 bg-blue-500 rounded-full border-4 border-white shadow-md z-10 flex items-center justify-center text-white font-bold">2</div>
          <div class="md:pl-12 order-2">
            <div class="bg-white p-6 rounded-2xl shadow-lg border-t-4 border-blue-500 relative">
              <h3 class="text-xl font-bold text-blue-700">‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏µ‡πà 2: ‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ó‡∏µ‡πà</h3>
              <span class="text-xs font-bold text-slate-400 uppercase tracking-wide">‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤: ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà 4-6</span>
              <p class="text-sm text-slate-600 mt-3 leading-relaxed">
                ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô ‚Äú‡∏á‡πà‡∏≤‡∏¢‚Äù ‡πÅ‡∏•‡∏∞ ‚Äú‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‚Äù ‡∏•‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤ ‚Äú‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏á‡∏µ‡∏¢‡∏ö‚Äù
              </p>
              <div class="mt-4 pt-4 border-t border-slate-100 text-left">
                <strong class="text-sm text-slate-700 block mb-2">üöÄ ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏•‡∏±‡∏Å:</strong>
                <ul class="text-sm text-slate-600 space-y-2">
                  <li>üîπ <strong>‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° IR ‡πÉ‡∏´‡πâ‡∏™‡∏±‡πâ‡∏ô:</strong> ‡∏•‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 2 ‡∏ô‡∏≤‡∏ó‡∏µ</li>
                  <li>üîπ <strong>‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• Good Job:</strong> ‡∏ä‡∏∑‡πà‡∏ô‡∏ä‡∏°‡∏ú‡∏π‡πâ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡∏û‡∏•‡∏≤‡∏î (Near Miss)</li>
                  <li>üîπ <strong>‡∏ß‡∏á‡∏à‡∏£‡∏õ‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö:</strong> ‡πÅ‡∏à‡πâ‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏°‡∏≤‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 7 ‡∏ß‡∏±‡∏ô</li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <div class="relative grid grid-cols-1 md:grid-cols-2 gap-8">
          <div class="md:text-right md:pr-12 order-1">
            <div class="bg-white p-6 rounded-2xl shadow-lg border-t-4 border-amber-500 relative">
              <h3 class="text-xl font-bold text-amber-600">‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏µ‡πà 3: ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏¢‡∏±‡πà‡∏á‡∏¢‡∏∑‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á</h3>
              <span class="text-xs font-bold text-slate-400 uppercase tracking-wide">‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤: ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà 7 ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô‡πÑ‡∏õ</span>
              <p class="text-sm text-slate-600 mt-3 leading-relaxed">
                ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤ ‡∏™‡∏π‡πà‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡πÄ‡∏ä‡∏¥‡∏á‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô (Proactive Learning)
              </p>
              <div class="mt-4 pt-4 border-t border-slate-100 text-left">
                <strong class="text-sm text-slate-700 block mb-2">üöÄ ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏•‡∏±‡∏Å:</strong>
                <ul class="text-sm text-slate-600 space-y-2">
                  <li>üîπ <strong>Safety Huddle:</strong> ‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏™‡∏±‡πâ‡∏ô 5-10 ‡∏ô‡∏≤‡∏ó‡∏µ‡∏ó‡∏∏‡∏Å‡πÄ‡∏ä‡πâ‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á</li>
                  <li>üîπ <strong>‡∏ó‡∏≥ RCA ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏±‡∏á:</strong> ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏´‡∏≤‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏ä‡∏¥‡∏á‡∏£‡∏∞‡∏ö‡∏ö ‡πÑ‡∏°‡πà‡πÇ‡∏ó‡∏©‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</li>
                  <li>üîπ <strong>‡πÅ‡∏ä‡∏£‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:</strong> ‡∏°‡∏≠‡∏á‡∏°‡∏∏‡∏° Safety-II ‡πÅ‡∏•‡∏∞‡πÅ‡∏ä‡∏£‡πå‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà ‚Äú‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏î‡∏µ‚Äù ‡∏Å‡∏±‡∏ö‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="absolute left-0 md:left-1/2 -translate-x-1/2 top-6 w-10 h-10 bg-amber-500 rounded-full border-4 border-white shadow-md z-10 flex items-center justify-center text-white font-bold">3</div>
          <div class="hidden md:block order-2"></div>
        </div>

      </div>
    </section>

  </main>

  <div class="container mx-auto px-4 pb-6">
    <div class="bg-slate-50 border border-slate-200 rounded-2xl p-5 shadow-sm">
      <p class="text-indigo-700 font-bold italic mb-1">
        ‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î (Disclaimer):
      </p>
      <p class="text-slate-600 text-sm leading-relaxed">
        ‡πÅ‡∏ú‡∏ô‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÇ‡∏î‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏Ç‡∏≠‡∏á AI (AI-Assisted) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û
        ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö/‡∏ó‡∏ß‡∏ô‡∏™‡∏≠‡∏ö‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏ö‡∏ó‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ ‡πÅ‡∏•‡∏∞‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏≥‡πÑ‡∏õ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏à‡∏£‡∏¥‡∏á
      </p>
    </div>
  </div>

  <script>
    async function callGemini(prompt) {
      const response = await fetch('/api/generate', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ prompt })
      });

      if (!response.ok) {
        let errData = {};
        try { errData = await response.json(); } catch (_) {}
        throw new Error(`Server Error: ${errData?.error?.message || response.statusText}`);
      }

      const data = await response.json();

      // ‚úÖ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö payload ‡∏Å‡∏±‡∏ô‡∏û‡∏±‡∏á
      if (typeof data?.text === 'string') return data.text;
      return data?.candidates?.[0]?.content?.parts?.[0]?.text ?? "";
    }

    function sanitizeLLMHtml(text) {
      const raw = String(text ?? "")
        .replace(/```(?:html)?/gi, "")
        .replace(/```/g, "")
        .trim();

      return raw.replace(/<script[\s\S]*?>[\s\S]*?<\/script>/gi, "");
    }

    function stripHtml(html) {
      const tmp = document.createElement("div");
      tmp.innerHTML = html;
      return (tmp.textContent || tmp.innerText || "").trim();
    }

    // ‚úÖ ‡πÉ‡∏´‡∏°‡πà: ‡∏î‡∏∂‡∏á ‚Äú‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå/‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‚Äù ‡∏à‡∏≤‡∏Å‡∏ú‡∏•‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1 (‡∏à‡∏≤‡∏Å HTML) ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏à‡∏≤‡∏Å input
    function extractEventOutcome(rootEl) {
      if (!rootEl) return "";

      const normalize = (s) => (s || "").replace(/\s+/g, " ").trim();

      // ‡∏´‡∏≤ <h3> ‡∏Ç‡∏≠‡∏á "1. ‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå"
      const h3s = Array.from(rootEl.querySelectorAll("h3"));
      const summaryH3 = h3s.find(h => {
        const t = normalize(h.textContent);
        return /1\.\s*/.test(t) && (t.includes("‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå") || t.toLowerCase().includes("event summary"));
      });

      const pickNextMeaningfulText = (startNode) => {
        if (!startNode) return "";
        let n = startNode.nextElementSibling;
        while (n) {
          if (n.tagName === "H3") break;
          const txt = normalize(n.textContent);
          if (txt.length >= 10) return txt;
          n = n.nextElementSibling;
        }
        return "";
      };

      let raw = summaryH3 ? pickNextMeaningfulText(summaryH3) : "";
      if (!raw) raw = normalize(rootEl.textContent).slice(0, 200);

      // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡πÅ‡∏£‡∏Å‡πÅ‡∏ö‡∏ö ‚Äú‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‚Äù ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ
      let title = raw;
      const cutIdx = (() => {
        const candidates = [
          title.indexOf("‡•§"),
          title.indexOf("."),
          title.indexOf("Ôºõ"),
          title.indexOf(";"),
          title.indexOf("Ôºö"),
          title.indexOf(":"),
          title.indexOf("\n")
        ].filter(i => i > 0);
        return candidates.length ? Math.min(...candidates) : -1;
      })();

      if (cutIdx > 0 && cutIdx < 90) title = title.slice(0, cutIdx + 1);
      title = normalize(title);

      if (title.length > 90) title = title.slice(0, 90) + "‚Ä¶";
      return title;
    }

    // ‚úÖ ‡πÉ‡∏´‡∏°‡πà: ‡πÅ‡∏™‡∏î‡∏á ‚Äú‡∏Å‡πâ‡∏≤‡∏á‡∏õ‡∏•‡∏≤‡πÅ‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á‚Äù ‡πÄ‡∏õ‡πá‡∏ô SVG ‡πÄ‡∏´‡∏ô‡∏∑‡∏≠ fishbone-grid ‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå/‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏ß‡∏•‡∏π‡∏Å‡∏®‡∏£
    function upgradeFishbone(rootEl, outcomeText) {
      if (!rootEl) return;

      const normalize = (s) => (s || "").replace(/\s+/g, " ").trim();

      const escapeXML = (s) =>
        String(s ?? "")
          .replace(/&/g, "&amp;")
          .replace(/</g, "&lt;")
          .replace(/>/g, "&gt;")
          .replace(/"/g, "&quot;")
          .replace(/'/g, "&apos;");

      const wrapByChars = (text, maxChars, maxLines = 3) => {
        const t = String(text ?? "").trim();
        if (!t) return [];
        const lines = [];
        let i = 0;
        while (i < t.length && lines.length < maxLines) {
          lines.push(t.slice(i, i + maxChars));
          i += maxChars;
        }
        if (i < t.length && lines.length) {
          lines[lines.length - 1] =
            lines[lines.length - 1].slice(0, Math.max(0, maxChars - 1)) + "‚Ä¶";
        }
        return lines;
      };

      // 1) ‡∏´‡∏≤ ‚Äú‡∏™‡πà‡∏ß‡∏ô‡∏Å‡πâ‡∏≤‡∏á‡∏õ‡∏•‡∏≤‚Äù ‡∏à‡∏≤‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ 3.* ‡πÑ‡∏õ‡∏à‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
      const findFishboneSection = () => {
        const h3s = Array.from(rootEl.querySelectorAll("h3"));
        const idx = h3s.findIndex((h) => {
          const t = normalize(h.textContent);
          return (
            (t.includes("3.") || t.match(/^3\b/)) &&
            (t.includes("‡∏Å‡πâ‡∏≤‡∏á‡∏õ‡∏•‡∏≤") ||
              t.toLowerCase().includes("fishbone") ||
              t.toLowerCase().includes("ishikawa"))
          );
        });
        if (idx < 0) {
          const idx2 = h3s.findIndex((h) => {
            const t = normalize(h.textContent);
            return (
              t.includes("‡∏Å‡πâ‡∏≤‡∏á‡∏õ‡∏•‡∏≤") ||
              t.toLowerCase().includes("fishbone") ||
              t.toLowerCase().includes("ishikawa")
            );
          });
          if (idx2 < 0) return null;
          return { h3: h3s[idx2], nextH3: h3s[idx2 + 1] || null };
        }
        return { h3: h3s[idx], nextH3: h3s[idx + 1] || null };
      };

      const section = findFishboneSection();
      if (!section || !section.h3) return;

      // 2) ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏≠‡πà‡∏≤‡∏ô‡∏à‡∏≤‡∏Å hidden JSON ‡∏Å‡πà‡∏≠‡∏ô (‡∏ó‡∏ô‡∏ó‡∏≤‡∏ô‡∏Å‡∏ß‡πà‡∏≤)
      const parseFromHiddenJSON = () => {
        let node = section.h3.nextElementSibling;
        while (node && node !== section.nextH3) {
          if (node.id === "fishbone-json") {
            try {
              const obj = JSON.parse(node.textContent || "{}");
              const cats = Array.isArray(obj.categories) ? obj.categories : [];
              const cleanCats = cats
                .map((c) => ({
                  label: normalize(c?.label || ""),
                  items: Array.isArray(c?.items)
                    ? c.items.map((x) => normalize(x)).filter(Boolean)
                    : [],
                }))
                .filter((c) => c.label)
                .slice(0, 6);

              const effect = normalize(obj.effect || "");
              return { effect, categories: cleanCats };
            } catch (_) {
              return null;
            }
          }
          node = node.nextElementSibling;
        }
        return null;
      };

      // 3) ‡∏™‡∏≥‡∏£‡∏≠‡∏á: ‡∏≠‡πà‡∏≤‡∏ô‡∏à‡∏≤‡∏Å .fishbone-grid/.fishbone-card (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
      const parseFromCards = () => {
        const grid = rootEl.querySelector(".fishbone-grid");
        if (!grid) return null;

        const cards = Array.from(grid.querySelectorAll(".fishbone-card"));
        const source = cards.length ? cards : Array.from(grid.children);

        const cats = [];
        for (const el of source) {
          const headerEl = el.querySelector ? el.querySelector(".fishbone-header") : null;
          const label = normalize(headerEl ? headerEl.textContent : "");
          if (!label) continue;

          const lis = Array.from(el.querySelectorAll("li"))
            .map((li) => normalize(li.textContent))
            .filter(Boolean);

          const items = (lis.length
            ? lis
            : normalize(el.textContent)
                .split(/„Éª|\n|„ÄÅ|‚Ä¢|-/g)
                .map(normalize)
                .filter((s) => s.length >= 4)
          )
            .filter((x) => x && x !== label)
            .slice(0, 5);

          cats.push({ label, items });
        }

        const categories = cats.slice(0, 6);
        if (!categories.length) return null;

        return { effect: "", categories };
      };

      const jsonData = parseFromHiddenJSON();
      const cardData = jsonData ? null : parseFromCards();

      const categories = (jsonData?.categories || cardData?.categories || []).slice(0, 6);
      if (!categories.length) return;

      const effectText = normalize(jsonData?.effect) || normalize(outcomeText) || "‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå / ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå";

      // ‚úÖ ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏ó‡∏≥ ‚Äú‡∏Ç‡∏≠‡∏ö‡∏Ç‡∏≤‡∏ß‚Äù ‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° ‡∏Å‡∏±‡∏ô‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£
      const textShieldStyle =
        "paint-order: stroke fill; stroke: #FFFFFF; stroke-width: 6px; stroke-linejoin: round;";

      const makeSVG = (cats, effect) => {
        const W = 1200, H = 620;
        const spineY = 310;
        const spineX1 = 120;

        const box = { x: 900, y: 240, w: 270, h: 140 };

        const usable = cats.slice(0, 6);
        const n = usable.length || 1;

        const xStart = 300;
        const xEnd = 860;
        const step = n > 1 ? (xEnd - xStart) / (n - 1) : 0;

        const topEndY = 120;
        const botEndY = 500;
        const endDx = 170;

        const ribsFractions = [0.35, 0.55, 0.75, 0.90];

        const bones = usable.map((c, idx) => {
          const x = xStart + step * idx;
          const isTop = idx % 2 === 0;

          const endX = x - endDx;
          const endY = isTop ? topEndY : botEndY;

          const labelW = 240;
          const labelH = 32;
          const labelX = endX - 10;
          const labelY = isTop ? endY - 46 : endY + 12;

          const label = escapeXML(c.label);
          const items = (c.items || []).slice(0, 4).map((s) =>
            s.length > 42 ? s.slice(0, 42) + "‚Ä¶" : s
          );

          const dx = endX - x;
          const dy = endY - spineY;
          const len = Math.hypot(dx, dy) || 1;
          const ux = dx / len, uy = dy / len;

          let px = -uy, py = ux;
          const outwardSign = isTop ? -1 : 1;
          px *= outwardSign; py *= outwardSign;

          // ‚úÖ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏™‡πâ‡∏ô‡∏¢‡πà‡∏≠‡∏¢‡∏¢‡∏≤‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô ‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡πâ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏° ‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡∏ö‡πÄ‡∏™‡πâ‡∏ô
          const ribLine = 46;
          const ribTextGap = 14;

          const ribs = items.map((txt, i) => {
            const f = ribsFractions[Math.min(i, ribsFractions.length - 1)];

            const sx = x + dx * f;
            const sy = spineY + dy * f;

            const ex = sx + px * ribLine;
            const ey = sy + py * ribLine;

            const tx = ex + px * ribTextGap;
            const ty = ey + (isTop ? -6 : 14);

            return `
              <line x1="${sx}" y1="${sy}" x2="${ex}" y2="${ey}" stroke="#475569" stroke-width="2" />
              <text x="${tx}" y="${ty}"
                    font-family="sans-serif"
                    font-size="12"
                    font-weight="600"
                    fill="#0F172A"
                    style="${textShieldStyle}">
                ${escapeXML(txt)}
              </text>
            `;
          }).join("");

          return `
            <line x1="${x}" y1="${spineY}" x2="${endX}" y2="${endY}" stroke="#334155" stroke-width="3" />
            <rect x="${labelX}" y="${labelY}" width="${labelW}" height="${labelH}" rx="10"
                  fill="#FFFFFF" stroke="#94A3B8" stroke-width="2" />
            <text x="${labelX + 12}" y="${labelY + 22}" font-family="sans-serif" font-size="14" font-weight="800"
                  fill="#0F172A" style="${textShieldStyle}">
              ${label}
            </text>
            ${ribs}
          `;
        }).join("");

        const headLines = wrapByChars(effect, 14, 3).map(escapeXML);
        const headTspans = headLines.map((t, i) =>
          `<tspan x="${box.x + box.w / 2}" dy="${i === 0 ? 0 : 20}">${t}</tspan>`
        ).join("");

        return `
          <svg viewBox="0 0 ${W} ${H}" class="w-full h-auto" preserveAspectRatio="xMinYMid meet">
            <defs>
              <marker id="ishikawaArrow" markerWidth="12" markerHeight="12" refX="10" refY="6" orient="auto">
                <path d="M0,0 L12,6 L0,12 Z" fill="#0EA5E9" />
              </marker>
            </defs>

            <circle cx="${spineX1}" cy="${spineY}" r="10" fill="#0F172A" />
            <text x="${spineX1}" y="${spineY - 18}" font-family="sans-serif" font-size="12" font-weight="700"
                  fill="#475569" text-anchor="middle" style="${textShieldStyle}">
              ‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏
            </text>

            <line x1="${spineX1}" y1="${spineY}" x2="${box.x}" y2="${spineY}" stroke="#0F172A" stroke-width="6"
                  marker-end="url(#ishikawaArrow)" />

            <rect x="${box.x}" y="${box.y}" width="${box.w}" height="${box.h}" rx="16"
                  fill="#FFFFFF" stroke="#0F172A" stroke-width="3" />

            <text x="${box.x + box.w / 2}" y="${box.y + 44}"
                  font-family="sans-serif" font-size="14" font-weight="900"
                  fill="#0F172A" text-anchor="middle" style="${textShieldStyle}">
              ‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå / ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
            </text>

            <text x="${box.x + box.w / 2}" y="${box.y + 78}"
                  font-family="sans-serif" font-size="18" font-weight="900"
                  fill="#0F172A" text-anchor="middle" style="${textShieldStyle}">
              ${headTspans}
            </text>

            ${bones}

            <text x="${spineX1 + 10}" y="${spineY + 26}" font-family="sans-serif" font-size="12" fill="#64748B"
                  style="${textShieldStyle}">
              Ishikawa / ‡∏Å‡πâ‡∏≤‡∏á‡∏õ‡∏•‡∏≤ (‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏´‡∏•‡∏±‡∏Å ‚Üí ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå)
            </text>
          </svg>
        `;
      };

      const vizId = "fishbone-viz";
      const existing = rootEl.querySelector("#" + vizId);
      if (existing) existing.remove();

      const wrapper = document.createElement("div");
      wrapper.id = vizId;
      wrapper.className =
        "fishbone-viz-wrap w-full bg-white rounded-xl border border-slate-200 p-3 mb-4 shadow-sm";
      wrapper.innerHTML = `
        <div class="flex items-center gap-2 mb-2">
          <span class="text-base">üêü</span>
          <div class="text-xs font-bold text-slate-700 uppercase tracking-wide">‡πÅ‡∏ú‡∏ô‡∏ú‡∏±‡∏á‡∏Å‡πâ‡∏≤‡∏á‡∏õ‡∏•‡∏≤ (Ishikawa Diagram)</div>
        </div>
        ${makeSVG(categories, effectText)}
        <div class="text-[11px] text-slate-500 mt-2">
          ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á (‡∏Å‡∏≤‡∏£‡πå‡∏î/‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£) ‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏ß‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°
        </div>
      `;

      section.h3.insertAdjacentElement("afterend", wrapper);
    }

    async function startFullAnalysis() {
      const input = document.getElementById('scenarioInput').value;
      const runButton = document.getElementById('combinedRunButton');
      const spinner = document.getElementById('runSpinner');
      const resultDiv = document.getElementById('analyzeResult');
      const planInput = document.getElementById('planInput');
      const planResultDiv = document.getElementById('planResult');

      if (!input.trim()) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå"); return; }

      runButton.disabled = true;
      spinner.classList.remove('hidden');
      resultDiv.classList.add('hidden');
      planResultDiv.classList.add('hidden');
      planInput.value = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå...';

      try {
        // ‚úÖ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô 1: ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ Swiss cheese ‡πÅ‡∏ô‡πà ‡πÜ
        const promptAnalysis = `
‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ (‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö RCA)
‡πÇ‡∏õ‡∏£‡∏î‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢: "${input}"

„Äê‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç„Äë
- ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô HTML ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ Markdown ‡πÅ‡∏•‡∏∞‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏™‡πà \`\`\`
- ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ 5 ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ô‡∏µ‡πâ ‚Äú‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‚Äù ‡πÅ‡∏•‡∏∞‡∏´‡πâ‡∏≤‡∏°‡∏™‡∏•‡∏±‡∏ö‡∏•‡∏≥‡∏î‡∏±‡∏ö:
  1) ‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå
  2) ‡πÑ‡∏ó‡∏°‡πå‡πÑ‡∏•‡∏ô‡πå‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå
  3) ‡πÅ‡∏ú‡∏ô‡∏ú‡∏±‡∏á‡∏Å‡πâ‡∏≤‡∏á‡∏õ‡∏•‡∏≤ (‡πÉ‡∏ä‡πâ <div class="fishbone-grid">)
  4) ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ó‡∏≥‡πÑ‡∏°-‡∏ó‡∏≥‡πÑ‡∏° (5 Whys)
  5) ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏™‡∏ß‡∏¥‡∏™‡∏ä‡∏µ‡∏™ (‡∏ï‡∏≤‡∏£‡∏≤‡∏á: ‡∏ä‡∏±‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö / ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó / ‡∏£‡∏π(‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà) / ‡∏°‡∏≤‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô)

„Äê‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö (‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÉ‡∏ä‡πâ‡∏ñ‡πâ‡∏≠‡∏¢‡∏Ñ‡∏≥‡∏ô‡∏µ‡πâ‡∏ï‡∏£‡∏á ‡πÜ)„Äë
<h3 class="font-bold text-lg text-teal-700 mb-2">1. ‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå</h3>
<h3 class="font-bold text-lg text-teal-700 mb-2">2. ‡πÑ‡∏ó‡∏°‡πå‡πÑ‡∏•‡∏ô‡πå‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå</h3>
<h3 class="font-bold text-lg text-amber-700 mb-2">3. ‡πÅ‡∏ú‡∏ô‡∏ú‡∏±‡∏á‡∏Å‡πâ‡∏≤‡∏á‡∏õ‡∏•‡∏≤ (‡πÅ‡∏ú‡∏ô‡∏ú‡∏±‡∏á‡∏≠‡∏¥‡∏ä‡∏¥‡∏Å‡∏≤‡∏ß‡∏∞)</h3>
<div class="fishbone-grid">
  <!-- ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏´‡∏°‡∏ß‡∏î‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ -->
  <div class="fishbone-card">
    <div class="fishbone-header">‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏ß‡∏î (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏Ñ‡∏ô/‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠/‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£/‡∏ß‡∏±‡∏™‡∏î‡∏∏/‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°/‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î)</div>
    <ul><li>‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢...</li></ul>
  </div>
</div>

„Äê‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡πâ‡∏≤‡∏á‡∏õ‡∏•‡∏≤„Äë
- ‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ 3. ‡πÅ‡∏ú‡∏ô‡∏ú‡∏±‡∏á‡∏Å‡πâ‡∏≤‡∏á‡∏õ‡∏•‡∏≤ (‡πÅ‡∏ú‡∏ô‡∏ú‡∏±‡∏á‡∏≠‡∏¥‡∏ä‡∏¥‡∏Å‡∏≤‡∏ß‡∏∞) ‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà hidden JSON ‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ ‚Äú‡πÄ‡∏™‡∏°‡∏≠‚Äù (‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô HTML ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•):
  <pre id="fishbone-json" style="display:none">
  {"effect":"(‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå/‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÅ‡∏ö‡∏ö‡∏™‡∏±‡πâ‡∏ô)","categories":[{"label":"‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£","items":["...","..."]},{"label":"‡∏£‡∏∞‡∏ö‡∏ö/‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£","items":["..."]}]}
  </pre>
- categories ‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 6 ‡∏´‡∏°‡∏ß‡∏î ‡πÅ‡∏•‡∏∞ items ‡∏ï‡πà‡∏≠‡∏´‡∏°‡∏ß‡∏î‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 5 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏™‡∏±‡πâ‡∏ô ‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö)

<h3 class="font-bold text-lg text-pink-600 mb-2">4. ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ó‡∏≥‡πÑ‡∏°-‡∏ó‡∏≥‡πÑ‡∏° (5 Whys)</h3>
<h3 class="font-bold text-lg text-green-700 mb-2">5. ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏™‡∏ß‡∏¥‡∏™‡∏ä‡∏µ‡∏™</h3>
<table class="rca-table w-full">
  <thead><tr><th>‡∏ä‡∏±‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</th><th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th><th>‡∏£‡∏π (‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà)</th><th>‡∏°‡∏≤‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô (‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠)</th></tr></thead>
  <tbody>...</tbody>
</table>
        `.trim();

        const resText = await callGemini(promptAnalysis);
        const htmlContent = sanitizeLLMHtml(resText);

        resultDiv.innerHTML = htmlContent;
        resultDiv.classList.remove('hidden');

        // ‚úÖ ‡πÉ‡∏´‡∏°‡πà: ‡∏´‡∏±‡∏ß‡∏•‡∏π‡∏Å‡∏®‡∏£‡πÉ‡∏ä‡πâ ‚Äú‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå/‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‚Äù ‡∏ó‡∏µ‡πà‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏ú‡∏•‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° input)
        const outcomeText = extractEventOutcome(resultDiv);
        upgradeFishbone(resultDiv, outcomeText);

        const cleanText = stripHtml(htmlContent);
        planInput.value = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£...';

        // ‚úÖ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô 2: ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ 4 ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏ô‡πà ‡πÜ
        const promptPlan = `
‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•
‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ ‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏õ‡πá‡∏ô ‚ÄúHTML ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‚Äù ‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ 4 ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ô‡∏µ‡πâ (‡∏´‡πâ‡∏≤‡∏°‡∏™‡∏•‡∏±‡∏ö) ‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ Markdown

‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå:
"${cleanText}"

(1) <h3>1. PDSA</h3>
  - ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô ‚Äú‡∏ï‡∏≤‡∏£‡∏≤‡∏á‚Äù ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô (‡∏´‡πâ‡∏≤‡∏°‡∏ó‡∏≥ PDSA ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏ß‡∏ô)
  - ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á HTML ‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ (‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ thead+tbody):
    <table class="pdsatable w-full">
      <thead><tr><th>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô</th><th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th></tr></thead>
      <tbody>
        <tr><td>‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô (Plan)</td><td><ul><li>...</li></ul></td></tr>
        <tr><td>‡∏ó‡∏≥ (Do)</td><td><ul><li>...</li></ul></td></tr>
        <tr><td>‡∏®‡∏∂‡∏Å‡∏©‡∏≤ (Study)</td><td><ul><li>...</li></ul></td></tr>
        <tr><td>‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á (Act)</td><td><ul><li>...</li></ul></td></tr>
      </tbody>
    </table>

(2) <h3>2. Action Plan</h3>
  - ‡∏ï‡∏≤‡∏£‡∏≤‡∏á (‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå)
  - ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå: ‡∏°‡∏≤‡∏ï‡∏£‡∏Å‡∏≤‡∏£ / ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö / ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à / KPI(‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå) / ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏•‡∏∞‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏•‡∏î‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á

(3) <h3>3. Initiative Ideas</h3>
  - ‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô Quick Wins(0-30 ‡∏ß‡∏±‡∏ô), ‡∏£‡∏∞‡∏¢‡∏∞‡∏Å‡∏•‡∏≤‡∏á(1-3 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô), ‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß(3-12 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)

(4) <h3>4. Conclusion & Recommendations</h3>
  - ‡∏™‡∏£‡∏∏‡∏õ 5 ‡∏Ç‡πâ‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
  - ‡∏ï‡∏≠‡∏ô‡∏ó‡πâ‡∏≤‡∏¢‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ ‚Äú‡∏Å‡πâ‡∏≤‡∏ß‡∏ñ‡∏±‡∏î‡πÑ‡∏õ (‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 72 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)‚Äù ‡πÄ‡∏™‡∏°‡∏≠
        `.trim();

        const resPlan = await callGemini(promptPlan);
        const planHtml = sanitizeLLMHtml(resPlan);

        planResultDiv.innerHTML = planHtml;
        planResultDiv.classList.remove('hidden');
        planInput.value = '‚úî ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß';

      } catch (error) {
        console.error(error);
        alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + error.message);
        planInput.value = "‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß";
      } finally {
        spinner.classList.add('hidden');
        runButton.disabled = false;
      }
    }

    function exportToWord() {
      const scenario = document.getElementById('scenarioInput').value;
      const riskAnalysis = document.getElementById('analyzeResult').innerHTML;
      const actionPlan = document.getElementById('planResult').innerHTML;

      if (!actionPlan) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Å‡πà‡∏≠‡∏ô"); return; }

      const content = `
        <html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
        <head><meta charset='utf-8'><title>‡πÅ‡∏ú‡∏ô‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</title></head>
        <body style="font-family: Arial, sans-serif;">
          <h1>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÅ‡∏ú‡∏ô‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</h1>
          <h2>1. ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á</h2>
          <p><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå:</strong> ${scenario}</p>
          ${riskAnalysis}
          <h2>2. ‡πÅ‡∏ú‡∏ô‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</h2>
          ${actionPlan}
        </body>
        </html>
      `;

      const blob = new Blob(['\ufeff', content], { type: 'application/msword' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `Safety_Plan_${new Date().toISOString().slice(0,10)}.doc`;
      link.click();
    }

    // Chart.js (‡∏ñ‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏Å‡∏£‡∏≤‡∏ü‡∏≠‡∏¢‡∏π‡πà)
    if (window.Chart && document.getElementById('assessmentChart')) {
      Chart.defaults.font.family = "'Noto Sans Thai', sans-serif";
      const ctx = document.getElementById('assessmentChart');
      const assessmentChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ['‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡∏°', '‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á', '‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Ç‡∏≠‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£', '‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏ï‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô', '‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏ß‡πâ‡∏≤‡∏á', '‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô', '‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô', '‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠/‡πÅ‡∏•‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'],
          datasets: [
            { label: '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô (%)', data: [0,0,0,0,0,0,0,0,0,0], backgroundColor: '#0D9488', borderRadius: 4 },
            { label: '‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ (100%)', data: [100,100,100,100,100,100,100,100,100,100], backgroundColor: '#E2E8F0', borderRadius: 4 }
          ]
        },
        options: {
          indexAxis: 'y',
          responsive: true,
          maintainAspectRatio: false,
          scales: { x: { suggestedMin: 0, max: 100 }, y: { grid: { display: false } } }
        }
      });

      window.updateChartData = function(index, value) {
        const el = document.getElementById(`val-${index}`);
        if (el) el.innerText = parseFloat(value).toFixed(2) + '%';
        assessmentChart.data.datasets[0].data[index] = value;
        assessmentChart.update();
      }
    }
  </script>

</body>
</html>
